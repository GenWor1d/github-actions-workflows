name: Docker网络管理
on:
  workflow_call:
    inputs:
      action:
        required: false
        type: string
        default: 'create'
      working-directory:
        required: false
        type: string
        default: 'deployment'

jobs:
  network:
    runs-on: ${{ github.ref_name }}
    defaults:
      run:
        working-directory: ${{ inputs.working-directory }}
    
    steps:
      - name: 创建网络
        if: inputs.action == 'create'
        run: |

          echo "[DEBUG] 加载环境变量..."
          source $GITHUB_WORKSPACE/.env || (echo "[ERROR] 环境变量加载失败"; exit 1)
          echo "[DEBUG] 网络名称: $NETWORK_NAME"

          echo "[DEBUG] 创建Docker网络: $NETWORK_NAME"
          docker network create $NETWORK_NAME && echo "[DEBUG] 网络创建成功" || echo "[DEBUG] 网络已存在"